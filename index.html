<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>A-Frame + GVRM (Working!)</title>
</head>
<body>
  <a-scene background="color: #222" embedded>
    <a-entity camera position="0 1.6 3" look-controls></a-entity>
    <a-entity light="type: directional; intensity: 1" position="1 2 1"></a-entity>
    
    <a-entity id="avatar" position="0 0 -2" rotation="0 180 0">
      <a-animation attribute="rotation" to="0 360 0" dur="10000" repeat="indefinite"></a-animation>
    </a-entity>
    
    <a-plane position="0 0 -3" rotation="-90 0 0" width="10" height="10" material="color: #444"></a-plane>
  </a-scene>

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.167.1/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.167.1/examples/jsm/"
    }
  }
  </script>

  <script type="module">
    import * as THREE from 'three';
    import { GVRM } from 'https://naruya.github.io/gs-edit/lib/gaussian-vrm.min.js';

    // Get A-Frame's Three.js objects (exactly like the snippet)
    const sceneEl = document.querySelector('a-scene');
    sceneEl.addEventListener('loaded', async () => {
      const scene = sceneEl.object3D;
      const camera = sceneEl.camera;
      const renderer = sceneEl.renderer;
      const avatarEl = document.getElementById('avatar');

      try {
        console.log('üîÑ Loading GVRM...');
        
        // EXACT snippet code - 1/3
        const gvrm = await GVRM.load('./sample.gvrm', scene, camera, renderer);
        
        // EXACT snippet code - 2/3  
        await gvrm.changeFBX('./Idle.fbx');
        
        // Attach to A-Frame entity
        avatarEl.object3D.add(gvrm.character.currentVrm.scene);
        
        // EXACT snippet code - 3/3
        renderer.setAnimationLoop(() => {
          gvrm.update();
        });

        console.log('‚úÖ GVRM LOADED! Spinning avatar ready.');
        
      } catch (error) {
        console.error('‚ùå GVRM failed:', error);
      }
    });
  </script>
</body>
</html>
